{"version":3,"file":"commonHelpers2.js","sources":["../src/img/shopping-list/trash-03.svg","../src/img/modal/modal-icons.svg#icon-amazon-logo","../src/img/modal/modal-icons.svg#icon-ibooks-logo","../src/js/shopping-page.js"],"sourcesContent":["export default \"__VITE_ASSET__b5e380f7__\"","export default \"__VITE_ASSET__be8b9ef3__$_#icon-amazon-logo__\"","export default \"__VITE_ASSET__00cbe9d7__$_#icon-ibooks-logo__\"","import Pagination from 'tui-pagination';\nimport 'tui-pagination/dist/tui-pagination.css';\nimport { getBookByIds } from './booksAPI';\nimport deleteBtnImg from '../img/shopping-list/trash-03.svg';\nimport { spinnerPlay, spinnerStop } from './spinner';\nimport amazon from '../img/modal/modal-icons.svg#icon-amazon-logo';\nimport ibooks from '../img/modal/modal-icons.svg#icon-ibooks-logo';\n\nconst refs = {\n  bookList: document.querySelector('.shopping-list-saved'),\n  emptyList: document.querySelector('.shopping-list-empty'),\n  pagination: document.querySelector('.tui-pagination'),\n};\nconst perPage = window.innerWidth >= 768 ? 3 : 4;\n\ncreateShoppingList();\n\nfunction getBooksStorage() {\n  const savedBooks = localStorage.getItem('shoppingIdList');\n  const bookIdArray = JSON.parse(savedBooks);\n  return bookIdArray;\n}\n\nasync function createShoppingList() {\n  const bookIds = getBooksStorage();\n  spinnerPlay(refs.bookList);\n  if (!bookIds || bookIds.length === 0) {\n    removeHidden(refs.emptyList);\n    setHidden(refs.pagination);\n  } else {\n    const booksArray = await getBookByIds(bookIds);\n\n    if (booksArray && booksArray.length !== 0) {\n      const chunkedArray = chunkArray(booksArray, perPage);\n      const currentPage = pagination.getCurrentPage();\n      renderBooks(chunkedArray[currentPage - 1]);\n      removeHidden(refs.pagination);\n\n      document\n        .querySelectorAll('.saved-item-delete-btn')\n        .forEach(btn => btn.addEventListener('click', removeBookFromStorage));\n    }\n  }\n  spinnerStop();\n}\n\nfunction shoppingListMarkup(books) {\n  return books\n    .map(\n      ({\n        _id,\n        book_image,\n        title,\n        list_name,\n        description,\n        author,\n        buy_links,\n      }) => {\n        const shopHrefs = buy_links.reduce((acc, item) => {\n          if (item.name === 'Amazon') {\n            acc.amazon = item.url;\n          }\n          if (item.name === 'Apple Books') {\n            acc.apple = item.url;\n          }\n          return acc;\n        }, {});\n\n        return `<li class=\"saved-item\">\n      <div class=\"saved-item-cover\">\n        <img\n          class=\"saved-item-cover-img\"\n          src=\"${book_image}\"\n          alt=\"${title}\"\n        />\n      </div>\n      <div class=\"saved-item-discription\">\n        <div class=\"saved-item-discription-top\">\n          <div class=\"saved-item-title-wrap\">\n            <h2 class=\"saved-item-title\">${title}</h2>\n            <p class=\"saved-item-genre\">${list_name}</p>\n          </div>\n          <button class=\"saved-item-delete-btn\" data-id=${_id}>\n            <img\n              class=\"delete-btn-img\"\n              src= ${deleteBtnImg}\n              alt=\"delete button\"\n            />\n          </button>\n        </div>\n        <p class=\"saved-item-short\">\n          ${description}\n        </p>\n        <div class=\"saved-item-wrap-bottom\">\n          <p class=\"saved-item-author\">${author}</p>\n          <ul class=\"saved-item-refer-list\">\n            <li class=\"saved-item-refer-item\">\n              <a\n                href=\"${shopHrefs.amazon}\"\n                class=\"saved-item-refer-item-link\"\n                target=\"_blank\"\n              >\n                <svg\n                  class=\"saved-item-refer-amazon-logo\"\n                  width=\"62\"\n                  height=\"19\"\n                >\n                  <use href=${amazon}></use>\n                </svg>\n              </a>\n            </li>\n            <li class=\"saved-item-refer-item\">\n              <a\n                href=\"${shopHrefs.apple}\"\n                class=\"saved-item-refer-item-link\"\n                target=\"_blank\"\n              >\n                <svg\n                  class=\"saved-item-refer-ibooks-logo\"\n                  width=\"16\"\n                  height=\"16\"\n                >\n                  <use href=${ibooks}></use>\n                </svg>\n              </a>\n            </li>\n          </ul>\n        </div>\n      </div>\n    </li>`;\n      }\n    )\n    .join('');\n}\n\nfunction renderBooks(books) {\n  const markup = shoppingListMarkup(books);\n  refs.bookList.insertAdjacentHTML('beforeend', markup);\n}\n\nfunction setHidden(el) {\n  el.classList.add('is-hidden');\n}\n\nfunction removeHidden(el) {\n  el.classList.remove('is-hidden');\n}\n\nfunction removeBookFromStorage(e) {\n  const id = e.currentTarget.dataset.id;\n  const bookIds = getBooksStorage();\n  const filtredBooks = bookIds.filter(bookId => id !== bookId);\n  localStorage.setItem('shoppingIdList', JSON.stringify(filtredBooks));\n  refs.bookList.innerHTML = '';\n  pagination.setTotalItems(getBooksStorage().length);\n  pagination.movePageTo(pagination.getCurrentPage());\n}\n\nconst container = document.getElementById('pagination');\n\nconst options = {\n  totalItems: getBooksStorage().length,\n  itemsPerPage: perPage,\n  visiblePages: 2,\n  page: 1,\n  centerAlign: true,\n  firstItemClassName: 'tui-first-child',\n  lastItemClassName: 'tui-last-child',\n  template: {\n    page: '<a href=\"#\" class=\"tui-page-btn\">{{page}}</a>',\n    currentPage:\n      '<strong class=\"tui-page-btn tui-is-selected\">{{page}}</strong>',\n    moveButton:\n      '<a href=\"#\" class=\"tui-page-btn tui-{{type}}\">' +\n      '<span class=\"tui-ico-{{type}}\">{{type}}</span>' +\n      '</a>',\n    disabledMoveButton:\n      '<span class=\"tui-page-btn tui-is-disabled tui-{{type}}\">' +\n      '<span class=\"tui-ico-{{type}}\">{{type}}</span>' +\n      '</span>',\n    moreButton:\n      '<a href=\"#\" class=\"tui-page-btn tui-{{type}}-is-ellip\">' +\n      '<span class=\"tui-ico-ellip\">...</span>' +\n      '</a>',\n  },\n};\n\nconst pagination = new Pagination(container, options);\n\npagination.on('afterMove', ({ page }) => {\n  refs.bookList.innerHTML = '';\n  createShoppingList();\n});\n\nfunction chunkArray(arr, chunkSize) {\n  let chunkedArray = [];\n  for (let i = 0; i < arr.length; i += chunkSize) {\n    chunkedArray.push(arr.slice(i, i + chunkSize));\n  }\n  return chunkedArray;\n}\n"],"names":["deleteBtnImg","amazon","ibooks","refs","perPage","createShoppingList","getBooksStorage","savedBooks","bookIds","spinnerPlay","removeHidden","setHidden","booksArray","getBookByIds","chunkedArray","chunkArray","currentPage","pagination","renderBooks","btn","removeBookFromStorage","spinnerStop","shoppingListMarkup","books","_id","book_image","title","list_name","description","author","buy_links","shopHrefs","acc","item","markup","el","id","filtredBooks","bookId","container","options","Pagination","page","arr","chunkSize","i"],"mappings":"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"}