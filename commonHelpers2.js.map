{"version":3,"file":"commonHelpers2.js","sources":["../src/img/shopping-list/trash-03.svg","../src/img/modal/modal-icons.svg#icon-amazon-logo","../src/img/modal/modal-icons.svg#icon-ibooks-logo","../src/img/shopping-list/icons-shop.svg","../src/js/shopping-page.js"],"sourcesContent":["export default \"__VITE_ASSET__b5e380f7__\"","export default \"__VITE_ASSET__ea93853a__$_#icon-amazon-logo__\"","export default \"__VITE_ASSET__774b0616__$_#icon-ibooks-logo__\"","export default \"__VITE_ASSET__6d8cea9d__\"","import Pagination from 'tui-pagination';\nimport 'tui-pagination/dist/tui-pagination.css';\nimport { getBookByIds } from './booksAPI';\nimport deleteBtnImg from '../img/shopping-list/trash-03.svg';\nimport { spinnerPlay, spinnerStop } from './spinner';\nimport { getBooksInList, removeBookFromList } from './local-storage';\nimport amazon from '../img/modal/modal-icons.svg#icon-amazon-logo';\nimport ibooks from '../img/modal/modal-icons.svg#icon-ibooks-logo';\nimport svgIcon from '../img/shopping-list/icons-shop.svg';\n\nconst refs = {\n  bookList: document.querySelector('.shopping-list-saved'),\n  emptyList: document.querySelector('.shopping-list-empty'),\n  pagination: document.querySelector('.tui-pagination'),\n};\nconst perPage = window.innerWidth >= 768 ? 3 : 4;\nconst visiblePages = window.innerWidth >= 768 ? 3 : 2;\ncreateShoppingList();\n\nasync function createShoppingList() {\n  const bookIds = getBooksInList();\n  setHidden(refs.pagination);\n  spinnerPlay(refs.bookList);\n  if (!bookIds || bookIds.length === 0) {\n    removeHidden(refs.emptyList);\n    setHidden(refs.pagination);\n  } else {\n    const booksArray = await getBookByIds(bookIds);\n\n    if (booksArray && booksArray.length !== 0) {\n      const chunkedArray = chunkArray(booksArray, perPage);\n      const currentPage = pagination.getCurrentPage();\n      renderBooks(chunkedArray[currentPage - 1]);\n      removeHidden(refs.pagination);\n\n      document\n        .querySelectorAll('.saved-item-delete-btn')\n        .forEach(btn => btn.addEventListener('click', removeBookFromStorage));\n    }\n  }\n  spinnerStop();\n}\n\nfunction shoppingListMarkup(books) {\n  return books\n    .map(\n      ({\n        _id,\n        book_image,\n        title,\n        list_name,\n        description,\n        author,\n        buy_links,\n      }) => {\n        const shopHrefs = buy_links.reduce((acc, item) => {\n          if (item.name === 'Amazon') {\n            acc.amazon = item.url;\n          }\n          if (item.name === 'Apple Books') {\n            acc.apple = item.url;\n          }\n          return acc;\n        }, {});\n\n        return `<li class=\"saved-item\">\n      <div class=\"saved-item-cover\">\n        <img\n          class=\"saved-item-cover-img\"\n          src=\"${book_image}\"\n          alt=\"${title}\"\n        />\n      </div>\n      <div class=\"saved-item-discription\">\n        <div class=\"saved-item-discription-top\">\n          <div class=\"saved-item-title-wrap\">\n            <h2 class=\"saved-item-title\">${title}</h2>\n            <p class=\"saved-item-genre\">${list_name}</p>\n          </div>\n          <button class=\"saved-item-delete-btn\" data-id=${_id}>\n            <img\n              class=\"delete-btn-img\"\n              src= ${deleteBtnImg}\n              alt=\"delete button\"\n            />\n          </button>\n        </div>\n        <p class=\"saved-item-short\">\n          ${description}\n        </p>\n        <div class=\"saved-item-wrap-bottom\">\n          <p class=\"saved-item-author\">${author}</p>\n          <ul class=\"saved-item-refer-list\">\n            <li class=\"saved-item-refer-item\">\n              <a\n                href=\"${shopHrefs.amazon}\"\n                class=\"saved-item-refer-item-link\"\n                target=\"_blank\"\n              >\n                <svg\n                  class=\"saved-item-refer-amazon-logo\"\n                  width=\"62\"\n                  height=\"19\"\n                >\n                  <use href=${amazon}></use>\n                </svg>\n              </a>\n            </li>\n            <li class=\"saved-item-refer-item\">\n              <a\n                href=\"${shopHrefs.apple}\"\n                class=\"saved-item-refer-item-link\"\n                target=\"_blank\"\n              >\n                <svg\n                  class=\"saved-item-refer-ibooks-logo\"\n                  width=\"16\"\n                  height=\"16\"\n                >\n                  <use href=${ibooks}></use>\n                </svg>\n              </a>\n            </li>\n          </ul>\n        </div>\n      </div>\n    </li>`;\n      }\n    )\n    .join('');\n}\n\nfunction renderBooks(books) {\n  const markup = shoppingListMarkup(books);\n  refs.bookList.insertAdjacentHTML('beforeend', markup);\n}\n\nfunction setHidden(el) {\n  el.classList.add('is-hidden');\n}\n\nfunction removeHidden(el) {\n  el.classList.remove('is-hidden');\n}\n\nfunction removeBookFromStorage(e) {\n  const id = e.currentTarget.dataset.id;\n  removeBookFromList(id);\n  refs.bookList.innerHTML = '';\n  pagination.setTotalItems(getBooksInList().length);\n  pagination.movePageTo(pagination.getCurrentPage());\n}\n\nconst container = document.getElementById('pagination');\n\nconst options = {\n  totalItems: getBooksInList().length,\n  itemsPerPage: perPage,\n  visiblePages: visiblePages,\n  page: 1,\n  centerAlign: true,\n  firstItemClassName: 'tui-first-child',\n  lastItemClassName: 'tui-last-child',\n  template: {\n    page: '<a href=\"#\" class=\"tui-page-btn\">{{page}}</a>',\n    currentPage:\n      '<strong class=\"tui-page-btn tui-is-selected\">{{page}}</strong>',\n    moveButton:\n      '<a href=\"#\" class=\"tui-page-btn tui-{{type}}\">' +\n      '<span class=\"tui-ico-{{type}}\">' +\n      `<svg >\n                    <use href = \"${svgIcon}#icon-pagination-{{type}}\"></use>\n                </svg>` +\n      '</span>' +\n      '</a>',\n    disabledMoveButton:\n      '<span class=\"tui-page-btn tui-is-disabled tui-{{type}}\">' +\n      '<span class=\"tui-ico-{{type}}\">' +\n      `<svg >\n                    <use href = \"${svgIcon}#icon-pagination-{{type}}\"></use>\n                </svg>` +\n      '</span>' +\n      '</span>',\n    moreButton:\n      '<a href=\"#\" class=\"tui-page-btn tui-{{type}}-is-ellip\">' +\n      '<span class=\"tui-ico-ellip\">...</span>' +\n      '</a>',\n  },\n};\n\nconst pagination = new Pagination(container, options);\n\npagination.on('afterMove', ({ page }) => {\n  refs.bookList.innerHTML = '';\n  createShoppingList();\n});\n\nfunction chunkArray(arr, chunkSize) {\n  let chunkedArray = [];\n  for (let i = 0; i < arr.length; i += chunkSize) {\n    chunkedArray.push(arr.slice(i, i + chunkSize));\n  }\n  return chunkedArray;\n}\n"],"names":["deleteBtnImg","amazon","ibooks","svgIcon","refs","perPage","visiblePages","createShoppingList","bookIds","getBooksInList","setHidden","spinnerPlay","removeHidden","booksArray","getBookByIds","chunkedArray","chunkArray","currentPage","pagination","renderBooks","btn","removeBookFromStorage","spinnerStop","shoppingListMarkup","books","_id","book_image","title","list_name","description","author","buy_links","shopHrefs","acc","item","markup","el","id","removeBookFromList","container","options","Pagination","page","arr","chunkSize","i"],"mappings":"+KAAA,MAAeA,EAAA,wDCAAC,EAAA,4ECAAC,EAAA,4ECAAC,EAAA,0DCUTC,EAAO,CACX,SAAU,SAAS,cAAc,sBAAsB,EACvD,UAAW,SAAS,cAAc,sBAAsB,EACxD,WAAY,SAAS,cAAc,iBAAiB,CACtD,EACMC,EAAU,OAAO,YAAc,IAAM,EAAI,EACzCC,EAAe,OAAO,YAAc,IAAM,EAAI,EACpDC,IAEA,eAAeA,GAAqB,CAClC,MAAMC,EAAUC,IAGhB,GAFAC,EAAUN,EAAK,UAAU,EACzBO,EAAYP,EAAK,QAAQ,EACrB,CAACI,GAAWA,EAAQ,SAAW,EACjCI,EAAaR,EAAK,SAAS,EAC3BM,EAAUN,EAAK,UAAU,MACpB,CACL,MAAMS,EAAa,MAAMC,EAAaN,CAAO,EAE7C,GAAIK,GAAcA,EAAW,SAAW,EAAG,CACzC,MAAME,EAAeC,EAAWH,EAAYR,CAAO,EAC7CY,EAAcC,EAAW,iBAC/BC,EAAYJ,EAAaE,EAAc,CAAC,CAAC,EACzCL,EAAaR,EAAK,UAAU,EAE5B,SACG,iBAAiB,wBAAwB,EACzC,QAAQgB,GAAOA,EAAI,iBAAiB,QAASC,CAAqB,CAAC,CACvE,CACF,CACDC,GACF,CAEA,SAASC,EAAmBC,EAAO,CACjC,OAAOA,EACJ,IACC,CAAC,CACC,IAAAC,EACA,WAAAC,EACA,MAAAC,EACA,UAAAC,EACA,YAAAC,EACA,OAAAC,EACA,UAAAC,CACR,IAAY,CACJ,MAAMC,EAAYD,EAAU,OAAO,CAACE,EAAKC,KACnCA,EAAK,OAAS,WAChBD,EAAI,OAASC,EAAK,KAEhBA,EAAK,OAAS,gBAChBD,EAAI,MAAQC,EAAK,KAEZD,GACN,CAAE,CAAA,EAEL,MAAO;AAAA;AAAA;AAAA;AAAA,iBAIEP,CAAU;AAAA,iBACVC,CAAK;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,2CAMqBA,CAAK;AAAA,0CACNC,CAAS;AAAA;AAAA,0DAEOH,CAAG;AAAA;AAAA;AAAA,qBAGxCzB,CAAY;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,YAMrB6B,CAAW;AAAA;AAAA;AAAA,yCAGkBC,CAAM;AAAA;AAAA;AAAA;AAAA,wBAIvBE,EAAU,MAAM;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,8BASV/B,CAAM;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wBAMZ+B,EAAU,KAAK;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,8BAST9B,CAAM;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,UAQ7B,CACF,EACA,KAAK,EAAE,CACZ,CAEA,SAASiB,EAAYK,EAAO,CAC1B,MAAMW,EAASZ,EAAmBC,CAAK,EACvCpB,EAAK,SAAS,mBAAmB,YAAa+B,CAAM,CACtD,CAEA,SAASzB,EAAU0B,EAAI,CACrBA,EAAG,UAAU,IAAI,WAAW,CAC9B,CAEA,SAASxB,EAAawB,EAAI,CACxBA,EAAG,UAAU,OAAO,WAAW,CACjC,CAEA,SAASf,EAAsB,EAAG,CAChC,MAAMgB,EAAK,EAAE,cAAc,QAAQ,GACnCC,EAAmBD,CAAE,EACrBjC,EAAK,SAAS,UAAY,GAC1Bc,EAAW,cAAcT,EAAgB,EAAC,MAAM,EAChDS,EAAW,WAAWA,EAAW,eAAgB,CAAA,CACnD,CAEA,MAAMqB,EAAY,SAAS,eAAe,YAAY,EAEhDC,EAAU,CACd,WAAY/B,EAAc,EAAG,OAC7B,aAAcJ,EACd,aAAcC,EACd,KAAM,EACN,YAAa,GACb,mBAAoB,kBACpB,kBAAmB,iBACnB,SAAU,CACR,KAAM,gDACN,YACE,iEACF,WACE;AAAA,mCAG6BH,CAAO;AAAA,mCAItC,mBACE;AAAA,mCAG6BA,CAAO;AAAA,sCAItC,WACE,mGAGH,CACH,EAEMe,EAAa,IAAIuB,EAAWF,EAAWC,CAAO,EAEpDtB,EAAW,GAAG,YAAa,CAAC,CAAE,KAAAwB,CAAI,IAAO,CACvCtC,EAAK,SAAS,UAAY,GAC1BG,GACF,CAAC,EAED,SAASS,EAAW2B,EAAKC,EAAW,CAClC,IAAI7B,EAAe,CAAA,EACnB,QAAS8B,EAAI,EAAGA,EAAIF,EAAI,OAAQE,GAAKD,EACnC7B,EAAa,KAAK4B,EAAI,MAAME,EAAGA,EAAID,CAAS,CAAC,EAE/C,OAAO7B,CACT"}